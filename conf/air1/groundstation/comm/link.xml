<?xml version='1.0'?>
<xefis-include>
	<module name='io/link' instance='input'>
		<settings>
			<setting name='failsafe-after' value='500 ms'/>
			<setting name='reacquire-after' value='150 ms'/>
		</settings>
		<properties>
			<property name='input' path='/link/data/to-groundstation'/>
			<property name='link-valid' path='/link/local/valid'/>
			<property name='failsafes' path='/link/local/failsafes'/>
			<property name='reacquires' path='/link/local/reacquires'/>
			<property name='error-bytes' path='/link/local/error-bytes'/>
			<property name='valid-bytes' path='/link/local/valid-bytes'/>
			<property name='valid-packets' path='/link/local/valid-packets'/>
		</properties>
		<protocol>
			<packet magic='ca:fe'>
				<signature random-bytes='1' signature-bytes='2' key='00:11:22:33'>
					<property bytes='4' path='/aircraft/settings/cmd/ias' type='speed'/>
					<property bytes='4' path='/aircraft/settings/cmd/altitude' type='length'/>
					<property bytes='4' path='/aircraft/settings/cmd/vertical-speed' type='speed'/>
					<property bytes='4' path='/aircraft/settings/cmd/magnetic-heading-track' type='angle'/>
					<property bytes='2' path='/aircraft/sensors/aoa/alpha' type='angle'/>
					<property bytes='2' path='/aircraft/sensors/aoa/alpha.maximum' type='angle'/>
					<property bytes='2' path='/aircraft/sensors/ahrs/orientation/pitch' type='angle'/>
					<property bytes='2' path='/aircraft/sensors/ahrs/orientation/roll' type='angle'/>
					<property bytes='2' path='/aircraft/sensors/ahrs/orientation/magnetic-heading' type='angle'/>
					<property bytes='8' path='/aircraft/sensors/gps/latitude' type='angle'/>
					<property bytes='8' path='/aircraft/sensors/gps/longitude' type='angle'/>
					<property bytes='4' path='/aircraft/sensors/gps/altitude-amsl' type='length'/>
					<property bytes='2' path='/aircraft/sensors/gps/accuracy.lateral' type='length'/>
					<property bytes='2' path='/aircraft/sensors/gps/accuracy.vertical' type='length'/>
					<property bytes='4' path='/aircraft/sensors/pressure/static' type='pressure'/>
					<property bytes='4' path='/aircraft/sensors/airspeed/ias' type='speed'/>
					<property bytes='4' path='/aircraft/sensors/air-temperature/static' type='temperature'/>
					<property bytes='4' path='/aircraft/sensors/radar-altimeter/altitude.agl' type='length'/>
					<property bytes='2' path='/aircraft/sensors/slip-skid/slip-skid' type='float'/>
					<property bytes='2' path='/aircraft/sensors/engines/1/thrust' type='float'/>
					<property bytes='2' path='/aircraft/sensors/engines/1/rpm' type='float'/>
					<property bytes='2' path='/aircraft/sensors/engines/1/n1' type='float'/>
					<property bytes='2' path='/aircraft/sensors/engines/1/n2' type='float'/>
					<property bytes='2' path='/aircraft/sensors/engines/1/egt' type='float'/>
					<property bytes='2' path='/aircraft/sensors/engines/1/epr' type='float'/>
					<property bytes='2' path='/aircraft/sensors/engines/1/pitch' type='angle'/>
					<property bytes='2' path='/aircraft/sensors/engines/2/thrust' type='float'/>
					<property bytes='2' path='/aircraft/sensors/engines/2/rpm' type='float'/>
					<property bytes='2' path='/aircraft/sensors/engines/2/n1' type='float'/>
					<property bytes='2' path='/aircraft/sensors/engines/2/n2' type='float'/>
					<property bytes='2' path='/aircraft/sensors/engines/2/egt' type='float'/>
					<property bytes='2' path='/aircraft/sensors/engines/2/epr' type='float'/>
					<property bytes='2' path='/aircraft/sensors/engines/2/pitch' type='angle'/>
					<property bytes='2' path='/aircraft/systems/fbw/stick/pitch' type='angle'/>
					<property bytes='2' path='/aircraft/systems/fbw/stick/roll' type='angle'/>
					<property bytes='2' path='/aircraft/systems/fd/pitch' type='angle'/>
					<property bytes='2' path='/aircraft/systems/fd/roll' type='angle'/>
					<bitfield>
						<!-- Sensors - sensors -->
						<property path='/aircraft/sensors/ahrs/serviceable' type='boolean' retained='true'/>
						<property path='/aircraft/sensors/airspeed/serviceable' type='boolean' retained='true'/>
						<property path='/aircraft/sensors/pressure/serviceable' type='boolean' retained='true'/>
						<property path='/aircraft/sensors/gps/serviceable' type='boolean' retained='true'/>
						<property path='/aircraft/sensors/radar-altimeter/serviceable' type='boolean' retained='true'/>
						<!-- Serviceable - computers -->
						<property path='/aircraft/systems/adc/altitude/amsl.serviceable' type='boolean' retained='true'/>
						<property path='/aircraft/systems/adc/speed/ias.serviceable' type='boolean' retained='true'/>
						<property path='/aircraft/systems/adc/vertical-speed/serviceable' type='boolean' retained='true'/>
						<property path='/aircraft/systems/fbw/serviceable' type='boolean' retained='true'/>
						<property path='/aircraft/systems/fd/serviceable' type='boolean' retained='true'/>
						<!-- CMD modes -->
						<property path='/aircraft/settings/cmd/speed-mode' type='integer' bits='4'/>
						<property path='/aircraft/settings/cmd/roll-mode' type='integer' bits='3'/>
						<property path='/aircraft/settings/cmd/pitch-mode' type='integer' bits='4'/>
						<!-- FBW modes -->
						<property path='/aircraft/settings/fbw/attitude-mode' type='integer' bits='2'/>
						<property path='/aircraft/settings/fbw/throttle-mode' type='integer' bits='1'/>
						<!-- Gear -->
						<property path='/aircraft/sensors/gear/setting.down' type='boolean' retained='true'/>
						<property path='/aircraft/sensors/gear/nose.up' type='boolean' retained='true'/>
						<property path='/aircraft/sensors/gear/nose.down' type='boolean' retained='true'/>
						<property path='/aircraft/sensors/gear/left.up' type='boolean' retained='true'/>
						<property path='/aircraft/sensors/gear/left.down' type='boolean' retained='true'/>
						<property path='/aircraft/sensors/gear/right.up' type='boolean' retained='true'/>
						<property path='/aircraft/sensors/gear/right.down' type='boolean' retained='true'/>
						<!-- Other flags -->
						<property path='/aircraft/systems/fd/altitude-acquired' type='boolean'/>
					</bitfield>
				</signature>
			</packet>
			<packet magic='e4:40'>
				<signature random-bytes='2' signature-bytes='2' key='44:55:66:77'>
					<property bytes='2' path='/link/remote/failsafes' type='integer'/>
					<bitfield>
						<property path='/link/remote/valid' type='boolean'/>
					</bitfield>
				</signature>
			</packet>
		</protocol>
	</module>
	<module name='io/link' instance='output'>
		<settings>
			<setting name='frequency' value='50 Hz'/>
		</settings>
		<properties>
			<property name='output' path='/link/data/to-aircraft'/>
		</properties>
		<protocol>
			<packet magic='e4:40'>
				<signature random-bytes='2' signature-bytes='4' key='88:99:aa:bb'>
					<property bytes='2' path='/input/stick/axis/1' type='float'/>
					<property bytes='2' path='/input/stick/axis/0' type='float'/>
					<property bytes='2' path='/input/pedals/axis/2' type='float'/>
					<property bytes='2' path='/input/stick/axis/2' type='float'/>
					<property bytes='4' path='/settings/pressure/qnh' type='pressure'/>
					<property bytes='4' path='/settings/course/magnetic' type='angle'/>
					<bitfield>
						<property path='/settings/pressure/use-std' type='boolean'/>
						<property path='/settings/lights/strobe' type='boolean'/>
						<property path='/settings/lights/position' type='boolean'/>
						<property path='/settings/lights/landing' type='boolean'/>
					</bitfield>
				</signature>
			</packet>
			<packet magic='a3:80' send-every='1000' send-offset='0'>
				<signature random-bytes='2' signature-bytes='4' key='cc:dd:ee:ff'>
					<property bytes='8' path='/settings/home/latitude' type='angle'/>
					<property bytes='8' path='/settings/home/longitude' type='angle'/>
				</signature>
			</packet>
		</protocol>
	</module>
</xefis-include>

